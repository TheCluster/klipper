# MakerPi M2030 pin mapping
[printer]
kinematics: cartesian
max_velocity: 150
max_accel: 3000
max_z_velocity: 5
max_z_accel: 100

[mcu]
serial: /dev/ttyACM0
baud: 250000
pin_map: arduino
restart_method: arduino

#[display]
#lcd_type: hd44780
#rs_pin: ar20
#e_pin: ar17
#d4_pin: ar16
#d5_pin: ar21
#d6_pin: ar5
#d7_pin: ar6
#encoder_pins: ^ar40, ^ar42
#click_pin: ^!ar19

[virtual_sdcard]
path: ~/.octoprint/uploads/

[tmc2209 stepper_x]
uart_pin: ar63				;analog9
#tx_pin: ar40
interpolate: True
run_current: 1.0
hold_current: 0.2
stealthchop_threshold: 200
driver_PWM_AUTOGRAD: True
driver_PWM_AUTOSCALE: True

[stepper_x]
step_pin: ar54				;analog0
dir_pin: ar55				;analog1
enable_pin: !ar38
microsteps: 16
rotation_distance: 40.542252628911694
endstop_pin: ^!ar3
position_endstop: 0
position_max: 210
homing_speed: 50.0

[tmc2209 stepper_y]
uart_pin: ar64				;analog10
#tx_pin: ar59				;analog5
interpolate: True
run_current: 1.0
hold_current: 0.2
stealthchop_threshold: 200
driver_PWM_AUTOGRAD: True
driver_PWM_AUTOSCALE: True

[stepper_y]
step_pin: ar60
dir_pin: !ar61
enable_pin: !ar56
microsteps: 16
rotation_distance: 40.542252628911694
endstop_pin: ^!ar14
position_endstop: 0
position_max: 210
homing_speed: 50.0

[tmc2209 stepper_z]
uart_pin: ar65				;analog11
#tx_pin: ar42
interpolate: True
run_current: 0.9
stealthchop_threshold: 30
driver_PWM_AUTOGRAD: True
driver_PWM_AUTOSCALE: True

[stepper_z]
step_pin: ar46
dir_pin: ar48
enable_pin: !ar62
microsteps: 16
rotation_distance: 8.025682182985554
endstop_pin: ^!ar18
position_endstop: 0
position_max: 285
homing_speed: 30.0

[tmc2209 extruder]
uart_pin: ar66                          ;analog11
#tx_pin: ar44
interpolate: True
run_current: 0.3
hold_current: 0.2
stealthchop_threshold: 200
driver_PWM_AUTOGRAD: True
driver_PWM_AUTOSCALE: True

[extruder]
step_pin: ar26
dir_pin: !ar28
enable_pin: !ar24
microsteps: 16
rotation_distance: 32.955715756951596
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: ar10
sensor_type: ATC Semitec 104GT-2
sensor_pin: analog13
control: pid
pid_Kp: 20.940
pid_Ki: 0.655
pid_Kd: 167.257
min_temp: 0
max_temp: 275

[heater_bed]
heater_pin: ar8
sensor_type: EPCOS 100K B57560G104F
sensor_pin: analog14
control: pid
pid_Kp: 313.75
pid_Ki: 59.84
pid_Kd: 411.25
min_temp: 5
max_temp: 100

[fan]
pin: ar9

[output_pin power_pin]
pin: !ar11
value: 1
shutdown_value: 0

[output_pin motors_fans_pin]
pin: !ar12
value: 1
shutdown_value: 0

#
# Custom G-Codes
#

# M80 - power on
[gcode_macro M80]
gcode: SET_PIN PIN=power_pin VALUE=1

# M81 - power off
[gcode_macro M81]
gcode: SET_PIN PIN=power_pin VALUE=0

[gcode_macro M188]
gcode: SET_PIN PIN=motors_fans_pin VALUE=1

[gcode_macro M189]
gcode: SET_PIN PIN=motors_fans_pin VALUE=0